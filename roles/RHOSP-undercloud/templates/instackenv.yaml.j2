nodes:
{% for vm in vms if not vm.profile == 'undercloud' %}
  - ports:
      - address: {{ vm.mac }}:00
        physical_network: ctlplane
    name: "{{ vm.name }}"
    capabilities: "node:{{ vm.name }},boot_option:local"
    cpu: {{ vm.vcpus }}
    memory: {{ (vm.memory / 1024) | int }}
    disk: {{ (vm.disk_size / 1073741824) | int }}
    arch: "x86_64"
    pm_type: "ipmi"
    pm_user: "admin"
    pm_password: "admin"
    pm_addr: "192.168.250.1"
    pm_port: "{{ vm.bmcport }}"
{% endfor %}

{% for node in physical %}
  - ports:
      - address: {{ node.mac }}
        physical_network: ctlplane
    name: "{{ node.name }}"
    capabilities: "node:{{ node.name }},boot_option:local"
    cpu: {{ node.cpus }}
    memory: {{ (node.memory / 1024) | int }}
    disk: {{ (node.disk_size / 1073741824) | int }}
    arch: "x86_64"
    pm_type: "{{ node.pm_type }}"
    pm_user: "{{ node.pm_user }}"
    pm_password: "{{ node.pm_password }}"
    pm_addr: "{{ node.pm_addr }}"
    pm_port: "{{ node.pm_port }}"
{% endfor %}
